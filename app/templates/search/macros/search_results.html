{% macro search_results(request, results, encodedQuery) %}
  {% set display_mode = request.GET.get('display', 'list') %}
  <ul class="etna-results etna-results--{{ display_mode }}">
    {% for result in results %}

      {% set details_url = url('records:details', kwargs={'id': result.iaid}) + '?search=' + encodedQuery %}

      {% if display_mode == 'grid' %}
        <li>
          <h3 class="tna-heading-s"><a href="{{ details_url }}">{{ result.summary_title | safe }}</a></h3>
          <dl class="etna-result-attributes etna-result-attributes--grid">
            <dt>Held by</dt>
            <dd>{{ result.held_by }}</dd>
            <dt>Date</dt>
            <dd>{{ result.date_covering }}</dd>
            <dt>Reference</dt>
            <dd>{{ result.reference_number }}</dd>
          </dl>
        </li>
      {% else %}
        <li>
          <dl class="etna-dl-chips">
            <dt>Catalogue level</dt>
            <dd>
              Item
            </dd>
          </dl>
          <h3><a href="{{ details_url }}">{{ result.summary_title | safe }}</a></h3>
          <p>{{ result.clean_description | truncate_preserve_mark_tags() | remove_string_case_insensitive('scope and content') | safe }}</p>
          <dl class="etna-result-attributes etna-result-attributes--list">
            <dt>Held by</dt>
            <dd>{{ result.held_by }}</dd>
            <dt>Date</dt>
            <dd>{{ result.date_covering }}</dd>
            <dt>Reference</dt>
            <dd>{{ result.reference_number }}</dd>
          </dl>
        </li>
      {% endif %}
    {% endfor %}
  </ul>
{% endmacro %}
